<!DOCTYPE html>
<html lang="en">

<head>
    <title>Colorado Officer-involved Shootings | The Denver Post</title>
    <meta charset="utf-8">
    <meta name="robots" content="noindex,follow">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <link href="https://fonts.googleapis.com/css?family=Roboto|Roboto+Condensed:700|Roboto+Mono" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.datatables.net/1.10.16/css/dataTables.foundation.min.css" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/foundation/6.2.4/foundation.min.css" />
    <link rel="stylesheet" href="//cdn.datatables.net/responsive/2.2.1/css/responsive.dataTables.min.css" />
    <link rel="stylesheet" href="//cdn.datatables.net/responsive/2.2.1/css/responsive.foundation.min.css" />
    <!-- <link rel="stylesheet" href="jquery.dataTables.yadcf.css" /> -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.12.1/jquery-ui.css" />
    <script src="https://code.jquery.com/jquery-3.3.1.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.12.1/jquery-ui.js"></script>
    <script src="https://cdn.datatables.net/1.10.16/js/jquery.dataTables.min.js"></script>
    <script src="https://cdn.datatables.net/1.10.16/js/dataTables.foundation.min.js"></script>
    <script src="https://cdn.jsdelivr.net/foundation/6.2.4/foundation.min.js"></script>
    <script src="//cdn.datatables.net/plug-ins/1.10.16/dataRender/datetime.js"></script>
    <script src="//cdn.datatables.net/responsive/2.2.1/js/dataTables.responsive.min.js"></script>
    <script src="//cdn.datatables.net/responsive/2.2.1/js/responsive.foundation.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/yadcf/0.9.2/jquery.dataTables.yadcf.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/moment.js/2.11.2/moment.min.js"></script>
    <script src="//cdn.datatables.net/plug-ins/1.10.19/sorting/datetime-moment.js"></script>
    <style>
    body {
        background-color: #fafafa;
        font-family: 'Roboto', sans-serif;
    }

    #main-container {
        /*width: 700px;
        margin: 0 auto;*/
    }

    .table-title {
        font-size: 2.2rem;
        line-height: 38px;
        font-weight: 700;
    }

    .instructions-text {
        color: red;
        font-size: .8em;
        font-style: italic;
        text-align: center;
    }

    #filters {
        font-size: .85rem;
    }

    #lockdowns-table-container {
        margin-top: 10px;
        padding: 10px;
    }

    #lockdowns-table {
        font-size: .85rem;
        font-family: 'Roboto', sans-serif;
    }

    button.yadcf-filter-reset-button {
        color: red;
        margin-left: 10px;
    }

    select {
        margin-top: 7px;
        margin-bottom: 0;
        font-size: .85rem;
    }

    .dem {
        background-color: lightblue;
        width: 15px;
        height: 15px;
        margin-left: .5em;
    }

    .rep {
        background-color: red;
        width: 15px;
        height: 15px;
        margin-left: .5em;
    }

    .yadcf-filter-range {
        height: 2.9em;
        border: 1px solid silver;
    }

    .filter-text {
        font-weight: bold;
        margin-top: .5em;
        margin-bottom: .5em;
    }
    </style>
</head>

<body>
    <div id="main-container">
        <div id="lockdowns-table-container">
            <div class="row">
                <div class="large-12 columns">
                    <h2 class="table-title">Colorado officer-involved shootings</h2>
                    <p class="body-text">Chatter and chatter and chatter and chatter and chatter and chatter and chatter and chatter and chatter and chatter and chatter and chatter and chatter and chatter and chatter and chatter and chatter and chatter and chatter and chatter and chatter.</p>
                    <p class="instructions-text">Use dropdown menus or keyword search to filter table &bull; click name to go to decision letter or news story &bull; click column headers to sort</p>
                </div>
            </div>
            <div id="filters">
                <div class="row">
                    <div class="large-3 medium-3 small-12 columns">
                        <span id="filter-1" style="font-weight: bold;"></span>
                    </div>
                    <div class="large-3 medium-3 small-12 columns">
                        <span id="filter-2" style="font-weight: bold;"></span>
                    </div>
                    <div class="large-3 medium-3 small-12 columns">
                        <span id="filter-3" style="font-weight: bold;"></span>
                    </div>
                    <div class="large-3 medium-3 small-12 columns">
                        <span id="filter-4" style="font-weight: bold;"></span>
                    </div>
                </div>
            </div>
            <!-- <div class="row">
            <div class="large-6 medium-6 small-12 left columns">
                <p class="filter-text">Filter by amount</p>
                <span id="income-filter" style="font-weight: bold;"></span>
            </div>
        </div> -->
        </div>
        <div class="row">
            <div class="large-12 columns">
                <table id="lockdown-table" cellspacing="0" width="100%">
                    <thead>
                        <tr>
                            <th></th>
                            <th data-priority="1">Agency</th>
                            <th data-priority="2">Date</th>
                            <th data-priority="3">Victim(s)</th>
                            <th data-priority="4">Condition</th>
                            <th data-priority="5">Armed</th>
                            <th>Officer(s)</th>
                            <th class="none">Address</th>
                            <th class="none">Location</th>
                            <th class="none">Letter</th>
                            <th>Year</th>
                            <th>Agency type</th>
                            <th>Map status</th>
                        </tr>
                    </thead>
                    <tfoot>
                    </tfoot>
                    <tbody>
                    </tbody>
                </table>
            </div>
        </div>
    </div>
    <script>
    var dataFile = 'ois-data.geojson'

    $(document).ready(function() {
        function disableDependentFilter(level, inuse) {
            if (level < 4) {
                filter = $('#yadcf-filter--example-' + level);
                yadcf.exResetFilters(lockdownTable, [level]);
                filter.prop('disabled', !inuse);

                disableDependentFilter(level + 1, false);
            }
        }

        var lockdownTable = $('#lockdown-table').DataTable({
            ajax: {
                'url': dataFile,
                'dataSrc': 'features'
            },
            pageLength: 15,
            responsive: {
                details: {
                    type: 'column'
                }
            },
            dom: '<if<t>lp>',
            columnDefs: [{
                    className: 'control',
                    orderable: false,
                    targets: 0
                },
                {
                    type: 'date',
                    targets: 2
                }
            ],
            order: [
                [1, 'asc']
            ],
            columns: [
                { data: 'properties.button' },
                {
                    data: 'properties.agency',
                    // render: function(data, type, row) {
                    //     if (data == 'DEM') {
                    //         return '<div class="dem">&nbsp;</div>'
                    //     } else if (data == 'REP') {
                    //         return '<div class="rep">&nbsp;</div>'
                    //     }
                    // }
                },
                {
                    data: 'properties.date'
                    // render: function(data, type, row) {
                    //     if (row.properties.letterUrl != '') {
                    //         return '<a href="' + row.properties.letterUrl + '" target="_blank">' + row.properties.date + '</a>'
                    //     } else {
                    //         return row.properties.date
                    //     }
                    // }
                },
                {
                    data: 'properties.victimName',
                    render: function(data, type, row) {
                        if (row.properties.letterUrl != '') {
                            return '<a href="' + row.properties.letterUrl + '" target="_blank">' + row.properties.victimName + '</a>'
                        } else {
                            return row.properties.victimName
                        }
                    }
                    //render: $.fn.dataTable.moment("MM/DD/YY")
                },
                {
                    data: 'properties.victimStatus'
                },
                {
                    data: 'properties.victimArmed'
                },
                {
                    data: 'properties.officerName'
                    //visible: false
                },
                {
                    data: 'properties.address'
                },
                {
                    data: 'properties.location'
                },
                {
                    data: 'properties.letterUrl',
                    visible: false
                },
                {
                    data: 'properties.year',
                    visible: false
                },
                {
                    data: 'properties.suburbCity',
                    visible: false
                },
                {
                    data: 'properties.statusMap',
                    visible: false
                }
            ],

            initComplete: function() {
                yadcf.init(lockdownTable, [{
                        column_number: 8,
                        filter_container_id: 'filter-1',
                        filter_default_label: 'Filter by location'
                    }, {
                        column_number: 1,
                        filter_container_id: 'filter-2',
                        filter_default_label: 'Filter by agency'
                    },
                    {
                        column_number: 12,
                        filter_container_id: 'filter-3',
                        filter_default_label: 'Filter by victim condition',
                        //column_data_type: 'rendered_html'
                    },
                    {
                        column_number: 5,
                        filter_container_id: 'filter-4',
                        filter_default_label: 'Filter by suspect armed',
                        //column_data_type: 'rendered_html'
                    }
                ], {
                    cumulative_filtering: true,
                    filter_reset_button_text: 'Reset filter'
                });

                // get it started
                disableDependentFilter(1, true);

                $('.yadcf-filter-reset-button').on('click', function() {
                    level = parseInt(this.id.split('-')[4]);
                    disableDependentFilter(level, true);
                });

                $('.yadcf-filter').on('change', function() {
                    level = parseInt(this.id.slice(-1));
                    inuse = $(this).hasClass('inuse');

                    disableDependentFilter(level + 1, inuse);
                });
            }
        });
    });
    </script>
</body>

</html>